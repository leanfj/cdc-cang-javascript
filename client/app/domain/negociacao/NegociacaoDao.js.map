{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoDao.js"],"names":["Negociacao","NegociacaoDao","constructor","connection","_connection","_store","adciona","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","target","error","apagaTodos","clear","listaTodos","negociacoes","cursor","openCursor","atual","result","value","_data","_quantidade","_valor","push","continue"],"mappings":";;;;;;AAASA,gB,iBAAAA,U;;;AAEF,YAAMC,aAAN,CAAoB;AACzBC,oBAAYC,UAAZ,EAAwB;AACtB,eAAKC,WAAL,GAAmBD,UAAnB;AACA,eAAKE,MAAL,GAAc,aAAd;AACD;;AAEDC,gBAAQC,UAAR,EAAoB;AAClB,iBAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,kBAAMC,UAAU,KAAKP,WAAL,CACbQ,WADa,CACD,CAAC,KAAKP,MAAN,CADC,EACc,WADd,EAEbQ,WAFa,CAED,KAAKR,MAFJ,EAGbS,GAHa,CAGTP,UAHS,CAAhB;;AAKAI,oBAAQI,SAAR,GAAoBC,KAAKP,SAAzB;AACAE,oBAAQM,OAAR,GAAkBD,KAAK;AACrBE,sBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,qBAAO,oCAAP;AACD,aAHD;AAID,WAXM,CAAP;AAYD;;AAEDY,qBAAa;AACX,iBAAO,IAAId,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,kBAAMC,UAAU,KAAKP,WAAL,CACbQ,WADa,CACD,CAAC,KAAKP,MAAN,CADC,EACc,WADd,EAEbQ,WAFa,CAED,KAAKR,MAFJ,EAGbkB,KAHa,EAAhB;;AAKAZ,oBAAQI,SAAR,GAAoBC,KAAKP,SAAzB;;AAEAE,oBAAQM,OAAR,GAAkBD,KAAK;AACrBE,sBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,qBAAO,wCAAP;AACD,aAHD;AAID,WAZM,CAAP;AAaD;;AAEDc,qBAAa;AACX,iBAAO,IAAIhB,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,kBAAMe,cAAc,EAApB;;AAEA,kBAAMC,SAAS,KAAKtB,WAAL,CACZQ,WADY,CACA,CAAC,KAAKP,MAAN,CADA,EACe,WADf,EAEZQ,WAFY,CAEA,KAAKR,MAFL,EAGZsB,UAHY,EAAf;;AAKAD,mBAAOX,SAAP,GAAmBC,KAAK;AACtB,oBAAMY,QAAQZ,EAAEI,MAAF,CAASS,MAAvB;;AAEA,kBAAID,KAAJ,EAAW;AACT,sBAAMrB,aAAa,IAAIP,UAAJ,CACjB4B,MAAME,KAAN,CAAYC,KADK,EAEjBH,MAAME,KAAN,CAAYE,WAFK,EAGjBJ,MAAME,KAAN,CAAYG,MAHK,CAAnB;;AAMAR,4BAAYS,IAAZ,CAAiB3B,UAAjB;AACAqB,sBAAMO,QAAN;AACD,eATD,MASO;AACL1B,wBAAQgB,WAAR;AACD;AACF,aAfD;;AAiBAC,mBAAOT,OAAP,GAAiBD,KAAK;AACpBE,sBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,qBAAO,wCAAP;AACD,aAHD;AAID,WA7BM,CAAP;AA8BD;AApEwB","file":"NegociacaoDao.js","sourcesContent":["import { Negociacao } from \"./Negociacao.js\";\n\nexport class NegociacaoDao {\n  constructor(connection) {\n    this._connection = connection;\n    this._store = \"negociacoes\";\n  }\n\n  adciona(negociacao) {\n    return new Promise((resolve, reject) => {\n      const request = this._connection\n        .transaction([this._store], \"readwrite\")\n        .objectStore(this._store)\n        .add(negociacao);\n\n      request.onsuccess = e => resolve();\n      request.onerror = e => {\n        console.log(e.target.error);\n        reject(\"Não foi possível salvar negociação\");\n      };\n    });\n  }\n\n  apagaTodos() {\n    return new Promise((resolve, reject) => {\n      const request = this._connection\n        .transaction([this._store], \"readwrite\")\n        .objectStore(this._store)\n        .clear();\n\n      request.onsuccess = e => resolve();\n\n      request.onerror = e => {\n        console.log(e.target.error);\n        reject(\"Não foi possível apagar as negociações\");\n      };\n    });\n  }\n\n  listaTodos() {\n    return new Promise((resolve, reject) => {\n      const negociacoes = [];\n\n      const cursor = this._connection\n        .transaction([this._store], \"readwrite\")\n        .objectStore(this._store)\n        .openCursor();\n\n      cursor.onsuccess = e => {\n        const atual = e.target.result;\n\n        if (atual) {\n          const negociacao = new Negociacao(\n            atual.value._data,\n            atual.value._quantidade,\n            atual.value._valor\n          );\n\n          negociacoes.push(negociacao);\n          atual.continue();\n        } else {\n          resolve(negociacoes);\n        }\n      };\n\n      cursor.onerror = e => {\n        console.log(e.target.error);\n        reject(\"Não foi possível listar as negociações\");\n      };\n    });\n  }\n}\n"]}